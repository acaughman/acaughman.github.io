---
title: "Visualizing California Oil Spills"
description: |
author:
  - name: Allie Caughman
    url: {}
date: 2022-02-28
output:
  distill::distill_article:
    self_contained: false
    code_folding: hide
---


```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)

library(tidyverse)
library(sf)
library(sp)
library(tmap)
```

### Overview

Here, I will plot several maps of oil spill incidents in California in 2008. The first interactively displaces the location type (inland, freshwater, or marine) for each oil spill. The second visualizes the number of oil spills per county.


```{r}
## Read in Spill Data
spills = read_sf(here::here("data", "ds394"), layer = "ds394") %>% 
  janitor::clean_names() %>% 
  st_transform(crs= 32610) #set coordinate system

## Read in California Counties
counties = read_sf(here::here("data"), layer = "california_county_shape_file") %>% 
  janitor::clean_names() %>% 
  select(name) %>% 
  st_set_crs(4326) %>%
  st_transform(crs = 32610) #set coordinate system
```


### Maps

##### Interactive Map of Spill Locations

```{r}
tmap_mode(mode="view") #set tmap mode for interactivity

tm_shape(spills) +
  tm_dots("specificlo", title = "Location Type") #create interactive map showing location type
```

##### Number of Spills per County

```{r}
inland_spills_count = spills %>% 
  filter(inlandmari == "Inland") %>%  #filter only inland spill
  group_by(localecoun) %>% 
  summarise(count = n())#get number of events in each county

county_spills = st_join(counties, inland_spills_count) %>%  #join the county and spill count dataset
  mutate(count = as.double(count)) %>% 
  mutate(count = case_when(
    is.na(count) ~ 0,
    !is.na(count) ~ count
  ))
```


Make a finalized static choropleth map in ggplot in which the fill color for each county 
depends on the count of oil spill events by county

```{r, fig.cap="Figure 1. California county colored by number of inland oil spill events in 2008. Los Angeles County has the largest number of oil spills"}

ggplot() +
  geom_sf(data = county_spills, aes(fill = count)) + #plot geom and fill by number of oil spills
  theme_bw() +
  scale_fill_gradientn(colors = c("lightgray", "yellow", "red")) #custom colors for map
```

### Citation
California Department of Fish and Game, Office of Spill Prevention and Response. (2009). Oil *Spill Incident Tracking [ds394]*. [Data set]

